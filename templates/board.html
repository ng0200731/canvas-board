{% extends "base.html" %}
{% block title %}{{ board.title }} — Canva Board{% endblock %}
{% block content %}
<div class="board-toolbar">
    <button id="btn-add-card">+ Card</button>
    <button id="btn-flowchart" class="{{ 'active' if board.view_mode == 'flowchart' }}">Flowchart</button>
    <button id="btn-freeform" class="{{ 'active' if board.view_mode == 'freeform' }}">Freeform</button>
    <button id="btn-save-positions" style="display:none;">Save</button>
    <span class="spacer"></span>
    <input type="text" id="search-input" placeholder="Search tags...">
    <button id="btn-share">Share</button>
    <button id="btn-export">Export</button>
</div>
<div id="canvas-container">
    <!-- Canvas controls (top-left overlay) -->
    <div id="canvas-controls">
        <button id="btn-center-all" title="Center all cards">⊙</button>
        <button id="btn-zoom-out" title="Zoom out">-</button>
        <span id="zoom-level">100%</span>
        <button id="btn-zoom-in" title="Zoom in">+</button>
        <button id="btn-layout-vertical" title="Vertical layout">↓</button>
        <button id="btn-layout-horizontal" title="Horizontal layout">→</button>
    </div>
    <div id="canvas"></div>
</div>

<!-- Card context menu -->
<div id="card-context-menu" class="card-context-menu" style="display:none;">
    <button data-action="edit-title">Edit Title</button>
    <button data-action="upload-file">Upload File</button>
    <button data-action="delete-card">Delete Card</button>
</div>

<!-- Hidden file input -->
<input type="file" id="file-upload-input" multiple style="display:none;"
       accept="image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx">

<!-- Share modal -->
<div id="share-modal" class="modal-overlay" style="display:none;">
    <div class="modal">
        <h3>Share Board</h3>
        <div id="share-link-section" style="display:none;">
            <label style="font-size:0.85rem;">Public link:</label>
            <input type="text" id="share-link-input" readonly>
            <button id="btn-copy-link">Copy</button>
        </div>
        <button id="btn-generate-link">Generate Link</button>
        <hr style="margin:1rem 0;border-color:#eee;">
        <h4 style="font-size:0.9rem;margin-bottom:0.5rem;">Send via Email</h4>
        <input type="email" id="send-email-to" placeholder="Recipient email">
        <button id="btn-send-email">Send Snapshot</button>
        <hr style="margin:1rem 0;border-color:#eee;">
        <button class="secondary" id="btn-close-share">Close</button>
    </div>
</div>

<script>
    const BOARD_ID = "{{ board.id }}";
    const BOARD_VIEW_MODE = "{{ board.view_mode }}";
</script>
<script src="{{ url_for('static', filename='js/leader-line.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/plain-draggable.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/board.js') }}"></script>
{% endblock %}
